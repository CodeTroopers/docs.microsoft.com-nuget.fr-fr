---
title: Migration de package.config vers les formats PackageReference | Documents Microsoft
author: karann-msft
ms.author: karann
manager: unniravindranathan
ms.date: 03/27/2018
ms.topic: article
ms.prod: nuget
ms.technology: ''
description: Pour plus d’informations sur la migration d’un projet à partir du format de gestion package.config à PackageReference pris en charge par NuGet 4.0 + et VS2017 et .NET Core 2.0
keywords: Utilitaire de migration de NuGet, migrer, références de package, projet des fichiers, PackageReference, packages.config, VS2017, Visual Studio 2017, NuGet 4, .NET Core 2.0
ms.reviewer:
- karann
- unnir
ms.workload:
- dotnet
- aspnet
ms.openlocfilehash: 10bd2fe95a6af11806a7edd7a43eaa497486fd80
ms.sourcegitcommit: ecb598c790d4154366bc92757ec7db1a51c34faf
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/03/2018
---
# <a name="migrate-from-packagesconfig-to-packagereference"></a><span data-ttu-id="4d475-104">Migrer à partir de packages.config vers PackageReference</span><span class="sxs-lookup"><span data-stu-id="4d475-104">Migrate from packages.config to PackageReference</span></span>

<span data-ttu-id="4d475-105">Visual Studio 2017 Version 15.7 Preview 3 et ultérieures prend en charge la migration d’un projet à partir de la [packages.config](./packages-config.md) format de gestion pour le [PackageReference](../consume-packages/Package-References-in-Project-Files.md) format.</span><span class="sxs-lookup"><span data-stu-id="4d475-105">Visual Studio 2017 Version 15.7 Preview 3 and later supports migrating a project from the [packages.config](./packages-config.md) management format to the [PackageReference](../consume-packages/Package-References-in-Project-Files.md) format.</span></span>

## <a name="benefits-of-using-packagereference"></a><span data-ttu-id="4d475-106">Avantages de l’utilisation de PackageReference</span><span class="sxs-lookup"><span data-stu-id="4d475-106">Benefits of using PackageReference</span></span>

* <span data-ttu-id="4d475-107">**Gérer toutes les dépendances du projet dans un seul emplacement**: tout comme les références entre projets et références d’assembly, le package NuGet référence (à l’aide de la `PackageReference` nœud) sont gérés directement dans les fichiers de projet au lieu d’utiliser un distinct fichier packages.config.</span><span class="sxs-lookup"><span data-stu-id="4d475-107">**Manage all project dependencies in one place**: Just like project to project references and assembly references, NuGet package references (using the `PackageReference` node) are managed directly within project files rather than using a separate packages.config file.</span></span>
* <span data-ttu-id="4d475-108">**Affichage ne soit pas encombré de dépendances de niveau supérieur**: contrairement à packages.config, PackageReference répertorie uniquement les packages NuGet que vous avez installé directement dans le projet.</span><span class="sxs-lookup"><span data-stu-id="4d475-108">**Uncluttered view of top-level dependencies**: Unlike packages.config, PackageReference lists only those NuGet packages you directly installed in the project.</span></span> <span data-ttu-id="4d475-109">Par conséquent, le Gestionnaire de Package NuGet UI et le fichier projet ne sont pas encombrés avec des dépendances de bas niveau.</span><span class="sxs-lookup"><span data-stu-id="4d475-109">As a result, the NuGet Package Manager UI and the project file aren't cluttered with down-level dependencies.</span></span>
* <span data-ttu-id="4d475-110">**Améliorations des performances**: lorsque vous utilisez PackageReference, les packages sont conservés dans le *global-packages* dossier (comme décrit dans [gestion des packages globaux et des dossiers cache](../consume-packages/managing-the-global-packages-and-cache-folders.md) plutôt que dans un `packages` dossier au sein de la solution.</span><span class="sxs-lookup"><span data-stu-id="4d475-110">**Performance improvements**: When using PackageReference, packages are maintained in the *global-packages* folder (as described on [Managing the global packages and cache folders](../consume-packages/managing-the-global-packages-and-cache-folders.md) rather than in a `packages` folder within the solution.</span></span> <span data-ttu-id="4d475-111">Par conséquent, PackageReference s’exécute plus vite et consomme moins d’espace disque.</span><span class="sxs-lookup"><span data-stu-id="4d475-111">As a result, PackageReference performs faster and consumes less disk space.</span></span>
* <span data-ttu-id="4d475-112">**Un meilleur contrôle sur les dépendances et les flux de contenu**: les fonctionnalités existantes de MSBuild vous permet de [conditionnellement faire référence à un package NuGet](../consume-packages/Package-References-in-Project-Files.md#adding-a-packagereference-condition) et choisissez des références de package par le framework cible, configuration, plateforme, ou autres tableaux croisés dynamiques.</span><span class="sxs-lookup"><span data-stu-id="4d475-112">**Fine control over dependencies and content flow**: Using the existing features of MSBuild allows you to [conditionally reference a NuGet package](../consume-packages/Package-References-in-Project-Files.md#adding-a-packagereference-condition) and choose package references per target framework, configuration, platform, or other pivots.</span></span>
* <span data-ttu-id="4d475-113">**PackageReference est en cours de développement active**: consultez [PackageReference émet sur GitHub](https://aka.ms/nuget-pr-improvements).</span><span class="sxs-lookup"><span data-stu-id="4d475-113">**PackageReference is under active development**: See [PackageReference issues on GitHub](https://aka.ms/nuget-pr-improvements).</span></span> <span data-ttu-id="4d475-114">packages.config n’est plus en cours de développement actif.</span><span class="sxs-lookup"><span data-stu-id="4d475-114">packages.config is no longer under active development.</span></span>

### <a name="limitations"></a><span data-ttu-id="4d475-115">Limitations</span><span class="sxs-lookup"><span data-stu-id="4d475-115">Limitations</span></span>

* <span data-ttu-id="4d475-116">NuGet PackageReference n’est pas disponible dans Visual Studio 2015 et versions antérieures.</span><span class="sxs-lookup"><span data-stu-id="4d475-116">NuGet PackageReference is not available in Visual Studio 2015 and earlier.</span></span> <span data-ttu-id="4d475-117">Les projets migrés peuvent être ouvert uniquement dans Visual Studio 2017.</span><span class="sxs-lookup"><span data-stu-id="4d475-117">Migrated projects can be opened only in Visual Studio 2017.</span></span>
* <span data-ttu-id="4d475-118">La migration n’est pas actuellement disponible pour les projets C++ et ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="4d475-118">Migration is not currently available for C++ and ASP.NET project.</span></span>
* <span data-ttu-id="4d475-119">Certains packages ne sont peut-être pas entièrement compatibles avec PackageReference.</span><span class="sxs-lookup"><span data-stu-id="4d475-119">Some packages may not be fully compatible with PackageReference.</span></span> <span data-ttu-id="4d475-120">Pour plus d’informations, consultez [des problèmes de compatibilité du package](#package-compatibility-issues).</span><span class="sxs-lookup"><span data-stu-id="4d475-120">For more information, see [package compatibility issues](#package-compatibility-issues).</span></span>

## <a name="migration-steps"></a><span data-ttu-id="4d475-121">Étapes de migration</span><span class="sxs-lookup"><span data-stu-id="4d475-121">Migration steps</span></span>

> [!Note]
> <span data-ttu-id="4d475-122">Avant le début de la migration, Visual Studio crée une sauvegarde du projet afin que vous puissiez [restaurer packages.config](#how-to-roll-back-to-packagesconfig) si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="4d475-122">Before migration begins, Visual Studio creates a backup of the project to allow you to [roll back to packages.config](#how-to-roll-back-to-packagesconfig) if necessary.</span></span>

1. <span data-ttu-id="4d475-123">Ouvrez une solution contenant le projet à l’aide `packages.config`.</span><span class="sxs-lookup"><span data-stu-id="4d475-123">Open a solution containing project using `packages.config`.</span></span>

1. <span data-ttu-id="4d475-124">Dans **l’Explorateur de solutions**, avec le bouton droit sur le **références** nœud ou la `packages.config` fichier et sélectionnez **migrer packages.config à PackageReference...** .</span><span class="sxs-lookup"><span data-stu-id="4d475-124">In **Solution Explorer**, right-click on the **References** node or the `packages.config` file and select **Migrate packages.config to PackageReference...**.</span></span>

1. <span data-ttu-id="4d475-125">L’utilitaire de migration analyse les références de package NuGet du projet et tente de les classer dans **dépendances de niveau supérieur** (ce répertoire vous avez installé les packages NuGet) et **Transitive dépendances**(les packages qui ont été installés en tant que dépendances de packages de niveau supérieur).</span><span class="sxs-lookup"><span data-stu-id="4d475-125">The migrator analyzes the project's NuGet package references and attempts to categorize them into **Top-level dependencies** (NuGet packages that you installed directory) and **Transitive dependencies** (packages that were installed as dependencies of top-level packages).</span></span>

   > [!Note]
   > <span data-ttu-id="4d475-126">PackageReference prend en charge la restauration des packages transitive et résout les dépendances dynamiquement, ce qui signifie que que dépendances transitives ne doivent pas être installés explicitement.</span><span class="sxs-lookup"><span data-stu-id="4d475-126">PackageReference supports transitive package restore and resolves dependencies dynamically, meaning that transitive dependencies need not be installed explicitly.</span></span>

1. <span data-ttu-id="4d475-127">(Facultatif) Vous pouvez choisir de traiter un package NuGet classé sous forme d’une dépendance transitive comme une dépendance de niveau supérieur en sélectionnant le **niveau supérieur** option pour le package.</span><span class="sxs-lookup"><span data-stu-id="4d475-127">(Optional) You may choose to treat a NuGet package classified as a transitive dependency as a top-level dependency by selecting the **Top-Level** option for the package.</span></span> <span data-ttu-id="4d475-128">Cette option est définie automatiquement pour les packages contenant des ressources qui ne passent pas de manière transitive (ceux de la `build`, `buildCrossTargeting`, `contentFiles`, ou `analyzers` dossiers) et ceux marqués comme une dépendance de développement (`developmentDependency = "true"`).</span><span class="sxs-lookup"><span data-stu-id="4d475-128">This option is automatically set for packages containing assets that do not flow transitively (those in the `build`, `buildCrossTargeting`, `contentFiles`, or `analyzers` folders) and those marked as a development dependency (`developmentDependency = "true"`).</span></span>

1. <span data-ttu-id="4d475-129">Examiner les [des problèmes de compatibilité du package](#package-compatibility-issues).</span><span class="sxs-lookup"><span data-stu-id="4d475-129">Review any [package compatibility issues](#package-compatibility-issues).</span></span>

1. <span data-ttu-id="4d475-130">Sélectionnez **OK** pour commencer la migration.</span><span class="sxs-lookup"><span data-stu-id="4d475-130">Select **OK** to begin the migration.</span></span>

1. <span data-ttu-id="4d475-131">À la fin de la migration, Visual Studio fournit un rapport avec un chemin d’accès à la sauvegarde, la liste des packages installés (dépendances de niveau supérieur), une liste des packages référencés en tant que dépendances transitives et une liste des problèmes de compatibilité identifiés au début de migration.</span><span class="sxs-lookup"><span data-stu-id="4d475-131">At the end of the migration, Visual Studio provides a report with a path to the backup, the list of installed packages (top-level dependencies), a list of packages referenced as transitive dependencies, and a list of compatibility issues identified at the start of migration.</span></span> <span data-ttu-id="4d475-132">Le rapport est enregistré dans le dossier de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="4d475-132">The report is saved to the backup folder.</span></span>

1. <span data-ttu-id="4d475-133">Valider que la solution se génère et s’exécute.</span><span class="sxs-lookup"><span data-stu-id="4d475-133">Validate that the solution builds and runs.</span></span> <span data-ttu-id="4d475-134">Si vous rencontrez des problèmes, [un problème de fichiers sur GitHub](https://github.com/NuGet/Home/issues/).</span><span class="sxs-lookup"><span data-stu-id="4d475-134">If you encounter problems, [file an issue on GitHub](https://github.com/NuGet/Home/issues/).</span></span>

## <a name="how-to-roll-back-to-packagesconfig"></a><span data-ttu-id="4d475-135">Comment le restaurer dans packages.config</span><span class="sxs-lookup"><span data-stu-id="4d475-135">How to roll back to packages.config</span></span>

1. <span data-ttu-id="4d475-136">Fermez le projet migré.</span><span class="sxs-lookup"><span data-stu-id="4d475-136">Close the migrated project.</span></span>

1. <span data-ttu-id="4d475-137">Copiez le fichier projet et `packages.config` à partir de la sauvegarde (en général `<solution_root>\MigrationBackup\<unique_guid>\<project_name>\`) dans le dossier du projet.</span><span class="sxs-lookup"><span data-stu-id="4d475-137">Copy the project file and `packages.config` from the backup (typically `<solution_root>\MigrationBackup\<unique_guid>\<project_name>\`) to the project folder.</span></span>

1. <span data-ttu-id="4d475-138">Ouvrez le projet.</span><span class="sxs-lookup"><span data-stu-id="4d475-138">Open the project.</span></span>

1. <span data-ttu-id="4d475-139">Ouvrez la Console du Gestionnaire de Package à l’aide de la **Outils > Gestionnaire de Package NuGet > Package Manager Console** commande de menu.</span><span class="sxs-lookup"><span data-stu-id="4d475-139">Open the Package Manager Console using the **Tools > NuGet Package Manager > Package Manager Console** menu command.</span></span>

1. <span data-ttu-id="4d475-140">Dans la Console, exécutez la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="4d475-140">Run the following command in the Console:</span></span>

   ```ps
   update-package -reinstall
   ```

## <a name="package-compatibility-issues"></a><span data-ttu-id="4d475-141">Problèmes de compatibilité de package</span><span class="sxs-lookup"><span data-stu-id="4d475-141">Package compatibility issues</span></span>

<span data-ttu-id="4d475-142">PackageReference ne prend pas en charge certains aspects qui étaient pris en charge dans packages.config.</span><span class="sxs-lookup"><span data-stu-id="4d475-142">Some aspects that were supported in packages.config are not supported in PackageReference.</span></span> <span data-ttu-id="4d475-143">L’utilitaire de migration analyse et détecte ces problèmes.</span><span class="sxs-lookup"><span data-stu-id="4d475-143">The migrator analyzes and detects such issues.</span></span> <span data-ttu-id="4d475-144">N’importe quel package qui comporte un ou plusieurs des problèmes suivants ne peut-être pas se comporter comme prévu après la migration.</span><span class="sxs-lookup"><span data-stu-id="4d475-144">Any package that has one or more of the following issues may not behave as expected after the migration.</span></span>

### <a name="installps1-scripts-are-ignored-when-the-package-is-installed-after-the-migration"></a><span data-ttu-id="4d475-145">les scripts de « install.ps1 » sont ignorés lorsque le package est installé après la migration</span><span class="sxs-lookup"><span data-stu-id="4d475-145">"install.ps1" scripts are ignored when the package is installed after the migration</span></span>

| | |
| --- | --- |
| <span data-ttu-id="4d475-146">**Description**</span><span class="sxs-lookup"><span data-stu-id="4d475-146">**Description**</span></span> | <span data-ttu-id="4d475-147">Avec PackageReference, les scripts PowerShell install.ps1 et uninstall.ps1 ne sont pas exécutées pendant l’installation ou désinstallation d’un package.</span><span class="sxs-lookup"><span data-stu-id="4d475-147">With PackageReference, install.ps1 and uninstall.ps1 PowerShell scripts are not executed while installing or uninstalling a package.</span></span> |
| <span data-ttu-id="4d475-148">**Impact potentiel**</span><span class="sxs-lookup"><span data-stu-id="4d475-148">**Potential impact**</span></span> | <span data-ttu-id="4d475-149">Les packages qui dépendent de ces scripts pour configurer le comportement de certains dans le projet de destination peut ne pas fonctionneront comme prévu.</span><span class="sxs-lookup"><span data-stu-id="4d475-149">Packages that depend on these scripts to configure some behavior in the destination project might not work as expected.</span></span> |

### <a name="content-assets-are-not-available-when-the-package-is-installed-after-the-migration"></a><span data-ttu-id="4d475-150">« contenus » ne sont pas disponibles lorsque le package est installé après la migration</span><span class="sxs-lookup"><span data-stu-id="4d475-150">"content" assets are not available when the package is installed after the migration</span></span>

| | |
| --- | --- |
| <span data-ttu-id="4d475-151">**Description**</span><span class="sxs-lookup"><span data-stu-id="4d475-151">**Description**</span></span> | <span data-ttu-id="4d475-152">Ressources dans d’un package `content` dossier ne sont pas pris en charge avec PackageReference et sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="4d475-152">Assets in a package's `content` folder are not supported with PackageReference and are ignored.</span></span> <span data-ttu-id="4d475-153">PackageReference ajoute la prise en charge de `contentFiles` d’avoir une meilleure prise en charge transitive et contenu partagé.</span><span class="sxs-lookup"><span data-stu-id="4d475-153">PackageReference adds support for `contentFiles` to have better transitive support and shared content.</span></span>  |
| <span data-ttu-id="4d475-154">**Impact potentiel**</span><span class="sxs-lookup"><span data-stu-id="4d475-154">**Potential impact**</span></span> | <span data-ttu-id="4d475-155">Ressources de `content` ne sont pas copiés dans le projet et le projet de code qui dépend de la présence de ces ressources requiert la refactorisation.</span><span class="sxs-lookup"><span data-stu-id="4d475-155">Assets in `content` are not copied into the project and project code that depends on the presence of those assets requires refactoring.</span></span>  |

### <a name="xdt-transforms-are-not-applied-when-the-package-is-installed-after-the-upgrade"></a><span data-ttu-id="4d475-156">Les transformations XDT ne sont pas appliquées lorsque le package est installé après la mise à niveau</span><span class="sxs-lookup"><span data-stu-id="4d475-156">XDT transforms are not applied when the package is installed after the upgrade</span></span>

| | |
| --- | --- |
| <span data-ttu-id="4d475-157">**Description**</span><span class="sxs-lookup"><span data-stu-id="4d475-157">**Description**</span></span> | <span data-ttu-id="4d475-158">Les transformations XDT ne sont pas pris en charge avec PackageReference et `.xdt` fichiers sont ignorés lors de l’installation ou désinstallation d’un package.</span><span class="sxs-lookup"><span data-stu-id="4d475-158">XDT transforms are not supported with PackageReference and `.xdt` files are ignored when installing or uninstalling a package.</span></span>   |
| <span data-ttu-id="4d475-159">**Impact potentiel**</span><span class="sxs-lookup"><span data-stu-id="4d475-159">**Potential impact**</span></span> | <span data-ttu-id="4d475-160">Les transformations XDT ne sont pas appliquées à tous les fichiers XML du projet, le plus souvent, `web.config.install.xdt` et `web.config.uninstall.xdt`, ce qui signifie que le projet` web.config` fichier n’est pas mis à jour lorsque le package est installé ou désinstallé.</span><span class="sxs-lookup"><span data-stu-id="4d475-160">XDT transforms are not applied to any project XML files, most commonly, `web.config.install.xdt` and `web.config.uninstall.xdt`, which means the project's` web.config` file is not updated when the package is installed or uninstalled.</span></span> |

### <a name="assemblies-in-the-lib-root-are-ignored-when-the-package-is-installed-after-the-migration"></a><span data-ttu-id="4d475-161">Assemblys à la racine de lib sont ignorés lorsque le package est installé après la migration</span><span class="sxs-lookup"><span data-stu-id="4d475-161">Assemblies in the lib root are ignored when the package is installed after the migration</span></span>

| | |
| --- | --- |
| <span data-ttu-id="4d475-162">**Description**</span><span class="sxs-lookup"><span data-stu-id="4d475-162">**Description**</span></span> | <span data-ttu-id="4d475-163">Avec PackageReference, présentent des assemblys à la racine de `lib` dossier sans un cible framework sous-dossier spécifique sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="4d475-163">With PackageReference, assemblies present at the root of `lib` folder without a target framework specific sub-folder are ignored.</span></span> <span data-ttu-id="4d475-164">NuGet recherche un sous-dossier mise en correspondance le moniker du framework cible (TFM) correspondant à la version du projet cible et installe les assemblys correspondants dans le projet.</span><span class="sxs-lookup"><span data-stu-id="4d475-164">NuGet looks for a sub-folder matching the target framework moniker (TFM) corresponding to the project’s target framework and installs the matching assemblies into the project.</span></span> |
| <span data-ttu-id="4d475-165">**Impact potentiel**</span><span class="sxs-lookup"><span data-stu-id="4d475-165">**Potential impact**</span></span> | <span data-ttu-id="4d475-166">Les packages qui n’ont pas un sous-dossier mise en correspondance le moniker du framework cible (TFM) correspondant à la version du projet cible ne peuvent pas se comporter comme prévu après la transition et Échec d’installation lors de la migration</span><span class="sxs-lookup"><span data-stu-id="4d475-166">Packages that do not have a sub-folder matching the target framework moniker (TFM) corresponding to the project’s target framework may not behave as expected after the transition or fail installation during the migration</span></span> |

## <a name="found-an-issue-report-it"></a><span data-ttu-id="4d475-167">A détecté un problème ?</span><span class="sxs-lookup"><span data-stu-id="4d475-167">Found an issue?</span></span> <span data-ttu-id="4d475-168">Signaler !</span><span class="sxs-lookup"><span data-stu-id="4d475-168">Report it!</span></span>

<span data-ttu-id="4d475-169">Si vous rencontrez un problème lors de la migration, veuillez [un problème de fichiers sur le référentiel NuGet GitHub](https://github.com/NuGet/Home/issues/).</span><span class="sxs-lookup"><span data-stu-id="4d475-169">If you run into a problem with the migration experience, please [file an issue on the NuGet GitHub repository](https://github.com/NuGet/Home/issues/).</span></span>
